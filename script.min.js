const ThemeManager={elements:{toggle:null,toggleMobile:null,icon:null,iconMobile:null,header:null},init(){this.cacheElements();this.applyInitialTheme();this.setupEventListeners()},cacheElements(){this.elements.toggle=document.getElementById("theme-toggle");this.elements.toggleMobile=document.getElementById("theme-toggle-mobile");this.elements.icon=this.elements.toggle?.querySelector("i");this.elements.iconMobile=this.elements.toggleMobile?.querySelector("i");this.elements.header=document.querySelector(".header")},getSystemTheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},getSavedTheme(){return localStorage.getItem("theme")},getCurrentTheme(){return document.documentElement.getAttribute("data-theme")},setTheme(theme){document.documentElement.setAttribute("data-theme",theme);localStorage.setItem("theme",theme);this.updateIcons(theme);this.updateHeaderBackground(theme)},applyInitialTheme(){const savedTheme=this.getSavedTheme();const initialTheme=savedTheme||this.getSystemTheme();document.documentElement.setAttribute("data-theme",initialTheme);this.updateIcons(initialTheme)},updateIcons(theme){const iconClass=theme==="dark"?"fas fa-sun":"fas fa-moon";const ariaLabel=theme==="dark"?"Cambiar a modo claro":"Cambiar a modo oscuro";if(this.elements.icon)this.elements.icon.className=iconClass;if(this.elements.iconMobile)this.elements.iconMobile.className=iconClass;if(this.elements.toggle){this.elements.toggle.setAttribute("aria-label",ariaLabel);this.elements.toggle.setAttribute("aria-pressed",theme==="dark"?"true":"false")}if(this.elements.toggleMobile){this.elements.toggleMobile.setAttribute("aria-label",ariaLabel);this.elements.toggleMobile.setAttribute("aria-pressed",theme==="dark"?"true":"false")}},updateHeaderBackground(theme){if(!this.elements.header)return;const isDark=theme==="dark";const isScrolled=window.scrollY>100;const opacity=isScrolled?.98:.95;const bgColor=isDark?"17, 24, 39":"255, 255, 255";this.elements.header.style.background=`rgba(${bgColor}, ${opacity})`},toggle(){const currentTheme=this.getCurrentTheme();const newTheme=currentTheme==="light"?"dark":"light";this.setTheme(newTheme)},setupEventListeners(){if(this.elements.toggle){this.elements.toggle.addEventListener("click",()=>this.toggle())}if(this.elements.toggleMobile){this.elements.toggleMobile.addEventListener("click",()=>this.toggle())}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e)=>{if(!this.getSavedTheme()){const newTheme=e.matches?"dark":"light";this.setTheme(newTheme)}})}};const ContactFormManager={form:null,submitBtn:null,originalBtnContent:"",config:{APPS_SCRIPT_URL:"https://script.google.com/macros/s/AKfycbyCFYEdsx8uUaGdiTX4BRbb5e3_E7X2sV5k8UoGlMApdMpat3JSZHy93RMy-X9Titf5Ew/exec",messageTypes:{success:"#10B981",error:"#EF4444",info:"#3B82F6"}},init(){this.form=document.getElementById("contactForm");if(this.form){this.submitBtn=this.form.querySelector(".submit-btn");this.originalBtnContent=this.submitBtn?.innerHTML||"";this.setupEventListeners();this.setupValidation()}},setupEventListeners(){this.form.addEventListener("submit",(e)=>this.handleSubmit(e))},setupValidation(){const requiredInputs=this.form.querySelectorAll("input[required], textarea[required]");requiredInputs.forEach((input)=>{input.addEventListener("blur",()=>this.validateField(input));input.addEventListener("input",()=>this.clearFieldValidation(input))})},validateField(field){const isValid=field.checkValidity();const errorDiv=document.getElementById(field.getAttribute("aria-describedby"));if(!isValid&&field.value.trim()!==""){field.classList.add("error");field.classList.remove("success");if(errorDiv){errorDiv.textContent=field.validationMessage;errorDiv.classList.add("show")}}else if(isValid&&field.value.trim()!==""){field.classList.remove("error");field.classList.add("success");if(errorDiv){errorDiv.classList.remove("show")}}},clearFieldValidation(field){field.classList.remove("error","success");const errorDiv=document.getElementById(field.getAttribute("aria-describedby"));if(errorDiv){errorDiv.classList.remove("show")}},handleSubmit(e){e.preventDefault();this.form.classList.add("form-submitted");const requiredInputs=this.form.querySelectorAll("input[required], textarea[required]");let isFormValid=true;requiredInputs.forEach((input)=>{this.validateField(input);if(!input.checkValidity()){isFormValid=false}});if(isFormValid){this.setLoadingState();const formData=new FormData(this.form);this.submitForm(formData)}else{const firstError=this.form.querySelector(".error");if(firstError){firstError.scrollIntoView({behavior:"smooth",block:"center"});firstError.focus()}}},setLoadingState(){if(this.submitBtn){this.submitBtn.classList.add("loading");this.submitBtn.innerHTML="Enviando...";this.submitBtn.disabled=true;const formGroups=this.form.querySelectorAll(".form-group");formGroups.forEach((group)=>{group.classList.add("loading")})}},restoreButtonState(){if(this.submitBtn){this.submitBtn.classList.remove("loading");this.submitBtn.innerHTML=this.originalBtnContent;this.submitBtn.disabled=false;const formGroups=this.form.querySelectorAll(".form-group");formGroups.forEach((group)=>{group.classList.remove("loading")})}},clearAllValidation(){this.form.classList.remove("form-submitted");const allInputs=this.form.querySelectorAll("input, textarea");allInputs.forEach((input)=>{this.clearFieldValidation(input)})},async submitForm(formData){try{const response=await fetch(this.config.APPS_SCRIPT_URL,{method:"POST",body:formData});const result=await response.json();this.handleResponse(result)}catch(error){console.error("Form submission error:",error);this.showMessage("Error de conexión. Verifica tu internet e intenta nuevamente.","error")}finally{this.restoreButtonState()}},handleResponse(result){if(result.status==="ok"){this.showMessage("¡Mensaje enviado correctamente! Te contactaremos pronto.","success");this.form.reset();this.clearAllValidation()}else if(result.status==="error"){const message=result.message?.includes("registro pendiente")?"Tu email ya está registrado y tenemos tu consulta pendiente. Te contactaremos pronto.":result.message||"Error al enviar el mensaje. Por favor intenta nuevamente.";const type=result.message?.includes("registro pendiente")?"info":"error";this.showMessage(message,type)}else{this.showMessage("Error al enviar el mensaje. Por favor intenta nuevamente.","error")}},showMessage(message,type){this.form.querySelectorAll(".form-message").forEach((msg)=>msg.remove());const messageDiv=document.createElement("div");messageDiv.className=`form-message form-message-${type}`;messageDiv.textContent=message;messageDiv.style.cssText=`padding:1rem;border-radius:10px;margin-top:1rem;font-weight:500;text-align:center;background:${this.config.messageTypes[type]||this.config.messageTypes.info};color:white;opacity:0;transform:translateY(10px);transition:all 0.3s ease`;this.form.appendChild(messageDiv);setTimeout(()=>{messageDiv.style.opacity="1";messageDiv.style.transform="translateY(0)"},10);setTimeout(()=>{messageDiv.style.opacity="0";messageDiv.style.transform="translateY(-10px)";setTimeout(()=>messageDiv.remove(),300)},6000)}};document.addEventListener("DOMContentLoaded",function(){ThemeManager.init();const mobileMenuBtn=document.querySelector(".mobile-menu-btn");const navMenu=document.querySelector(".nav-menu");const navLinks=document.querySelectorAll(".nav-link");if(mobileMenuBtn&&navMenu){mobileMenuBtn.addEventListener("click",function(){const isOpen=navMenu.classList.contains("active");navMenu.classList.toggle("active");this.setAttribute("aria-expanded",!isOpen);this.setAttribute("aria-label",!isOpen?"Cerrar menú de navegación":"Abrir menú de navegación");const spans=mobileMenuBtn.querySelectorAll("span");spans.forEach((span,index)=>{if(navMenu.classList.contains("active")){if(index===0)span.style.transform="rotate(45deg) translate(5px, 5px)";if(index===1)span.style.opacity="0";if(index===2)span.style.transform="rotate(-45deg) translate(7px, -6px)"}else{span.style.transform="none";span.style.opacity="1"}})})}const allNavItems=document.querySelectorAll(".nav-link, .nav-cta-btn");allNavItems.forEach((link)=>{link.addEventListener("click",function(){navMenu.classList.remove("active");mobileMenuBtn.setAttribute("aria-expanded","false");mobileMenuBtn.setAttribute("aria-label","Abrir menú de navegación");const spans=mobileMenuBtn.querySelectorAll("span");spans.forEach((span)=>{span.style.transform="none";span.style.opacity="1"})})});document.addEventListener("click",function(e){const isMenuOpen=navMenu.classList.contains("active");const clickedInsideMenu=navMenu.contains(e.target);const clickedMenuButton=mobileMenuBtn.contains(e.target);if(isMenuOpen&&!clickedInsideMenu&&!clickedMenuButton){navMenu.classList.remove("active");mobileMenuBtn.setAttribute("aria-expanded","false");mobileMenuBtn.setAttribute("aria-label","Abrir menú de navegación");const spans=mobileMenuBtn.querySelectorAll("span");spans.forEach((span)=>{span.style.transform="none";span.style.opacity="1"})}});document.querySelectorAll('a[href^="#"]').forEach((anchor)=>{anchor.addEventListener("click",function(e){e.preventDefault();const target=document.querySelector(this.getAttribute("href"));if(target){target.scrollIntoView({behavior:"smooth",block:"start"})}})});window.addEventListener("scroll",function(){const currentTheme=ThemeManager.getCurrentTheme();ThemeManager.updateHeaderBackground(currentTheme);if(ThemeManager.elements.header){const blur=window.scrollY>100?"blur(20px)":"blur(10px)";ThemeManager.elements.header.style.backdropFilter=blur}});const observerOptions={threshold:0.1,rootMargin:"0px 0px -50px 0px"};const observer=new IntersectionObserver(function(entries){entries.forEach((entry)=>{if(entry.isIntersecting){entry.target.style.opacity="1";entry.target.style.transform="translateY(0)"}})},observerOptions);const animatedElements=document.querySelectorAll(".benefit-item");animatedElements.forEach((el)=>{el.style.opacity="0";el.style.transform="translateY(30px)";el.style.transition="opacity 0.6s ease, transform 0.6s ease";observer.observe(el)});const hero=document.querySelector(".hero");window.addEventListener("scroll",function(){const scrolled=window.pageYOffset;const parallaxSpeed=0.5;if(hero&&scrolled<hero.offsetHeight){hero.style.transform=`translateY(${scrolled*parallaxSpeed}px)`}});const serviceTabs=document.querySelectorAll(".service-tab");const serviceDetails=document.querySelectorAll(".service-detail");const servicePlaceholder=document.querySelector(".service-placeholder");if(servicePlaceholder){servicePlaceholder.classList.add("active")}serviceTabs.forEach((tab)=>{tab.addEventListener("click",function(){if(this.classList.contains("active")){return}const serviceId=this.getAttribute("data-service");serviceTabs.forEach((t)=>t.classList.remove("active"));serviceDetails.forEach((d)=>{d.classList.remove("active");d.style.display="none"});if(servicePlaceholder){servicePlaceholder.classList.remove("active")}this.classList.add("active");const targetDetail=document.getElementById(serviceId);if(targetDetail){targetDetail.style.display="block";targetDetail.classList.add("loading");setTimeout(()=>{targetDetail.classList.remove("loading");targetDetail.classList.add("active")},300)}});tab.addEventListener("mouseenter",function(){if(!this.classList.contains("active")){this.style.transform="translateX(8px)";this.style.boxShadow="0 6px 25px rgba(107, 70, 193, 0.15)"}});tab.addEventListener("mouseleave",function(){if(!this.classList.contains("active")){this.style.transform="translateX(0)";this.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.05)"}})});document.addEventListener("click",function(e){if(!e.target.closest(".services-tabs-container")){}});const lazyLoad=()=>{const images=document.querySelectorAll("img[data-src]");const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach((entry)=>{if(entry.isIntersecting){const img=entry.target;img.classList.add("lazy");const newImg=new Image();newImg.onload=()=>{img.src=img.dataset.src;img.classList.remove("lazy")};newImg.src=img.dataset.src;imageObserver.unobserve(img)}})});images.forEach((img)=>imageObserver.observe(img))};lazyLoad();const backToTopBtn=document.getElementById("backToTop");const heroSection=document.querySelector(".hero");if(backToTopBtn&&heroSection){window.addEventListener("scroll",function(){const heroHeight=heroSection.offsetHeight;if(window.scrollY>heroHeight*0.6){backToTopBtn.classList.add("show")}else{backToTopBtn.classList.remove("show")}})}if(backToTopBtn){backToTopBtn.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}const whatsappBtn=document.querySelector(".whatsapp-btn");if(whatsappBtn){setInterval(()=>{whatsappBtn.style.transform="scale(1.05)";setTimeout(()=>{whatsappBtn.style.transform="scale(1)"},200)},3000)}ContactFormManager.init();const accordionHeaders=document.querySelectorAll(".accordion-header");accordionHeaders.forEach((header)=>{header.addEventListener("click",function(){const currentlyActive=this.classList.contains("active");const content=this.nextElementSibling;accordionHeaders.forEach((h)=>{h.classList.remove("active");h.nextElementSibling.classList.remove("active")});if(!currentlyActive){this.classList.add("active");content.classList.add("active")}})})});